{"version":3,"file":"haro.min.js","sources":["haro.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","blob","arg","obj","undefined","Blob","type","e","BlobBuilder","MSBlobBuilder","WebKitBlobBuilder","MozBlobBuilder","append","getBlob","clone","JSON","parse","stringify","concatURI","left","right","replace","regex","querystring","endslash","keyIndex","data","delimiter","pattern","keys","split","sort","result","map","String","RegExp","toLowerCase","join","delIndex","index","indexes","forEach","idx","get","value","o","has","size","iterate","fn","call","merge","a","b","c","d","Array","concat","patch","ogdata","arguments","overwrite","v","k","push","op","path","s","Math","random","toString","substring","setIndexValue","set","Set","add","setIndex","indice","toObjekt","uuid","substr","r","floor","factory","config","Haro","fns","webWorker","worker","URL","createObjectURL","server","process","nextTick","Promise","require","Map","fetch","deferred","tuple","Worker","adapter","_this","this","adapters","method","credentials","headers","accept","content-type","id","logging","registry","source","total","uri","versions","versioning","reindex","batch","args","next","all","then","defer","resolve","reject","_this2","lload","del","hash","toArray","toObject","request","body","promise","clear","console","log","_len","_key","apply","Error","_this3","indexOf","shift","pop","splice","storage","success","error","message","stack","transform","entries","where","_this4","ctx","output","max","offset","lmax","loffset","list","nth","_this5","cmd","_this6","datum","_this7","input","cfg","toUpperCase","res","status","_headers","_this8","_this9","rgex","test","seen","lindex","lset","lkey","_this10","override","ldata","luri","xdata","err","sync","frozen","freeze","_this11","_this12","_len2","_key2","deferreds","_this13","Allow","allow","reduce","val","func","_this14","_this15","values","version","exports","module","define","haro","window"],"mappings":"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","sourcesContent":["/**\n * Har≈ç is a modern immutable DataStore using Maps, Sets, Promises, & Tuples\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2015\n * @license BSD-3-Clause\n * @link http://haro.rocks\n * @version 1.6.2\n */\n\"use strict\";\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (global) {\n\tvar server = typeof process !== \"undefined\" && typeof process.nextTick === \"function\";\n\tvar Promise = !server ? global.Promise : require(\"es6-promise\").Promise;\n\tvar Map = !server ? global.Map : require(\"es6-map\");\n\tvar Set = !server ? global.Set : require(\"es6-set\");\n\tvar fetch = !server ? global.fetch : require(\"node-fetch\");\n\tvar deferred = !server ? global.deferred : require(\"tiny-defer\");\n\tvar tuple = !server ? global.tuple : require(\"tiny-tuple\");\n\tvar r = [8, 9, \"a\", \"b\"];\n\tvar regex = {\n\t\tquerystring: /\\?.*/,\n\t\tendslash: /\\/$/\n\t};\n\tvar webWorker = typeof Blob !== \"undefined\" && typeof Worker !== \"undefined\";\n\tvar adapter = {};\n\n\tfunction blob(arg) {\n\t\tvar obj = undefined;\n\n\t\ttry {\n\t\t\tobj = new Blob([arg], { type: \"application/javascript\" });\n\t\t} catch (e) {\n\t\t\tif (!global.BlobBuilder) {\n\t\t\t\tglobal.BlobBuilder = global.MSBlobBuilder || global.WebKitBlobBuilder || global.MozBlobBuilder;\n\t\t\t}\n\n\t\t\tobj = new global.BlobBuilder().append(arg).getBlob();\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tfunction clone(arg) {\n\t\treturn JSON.parse(JSON.stringify(arg));\n\t}\n\n\tfunction concatURI(left, right) {\n\t\treturn left.replace(regex.querystring, \"\").replace(regex.endslash, \"\") + (right ? \"/\" + right : \"\");\n\t}\n\n\tfunction keyIndex(key, data, delimiter, pattern) {\n\t\tvar keys = key.split(delimiter).sort(),\n\t\t    result = undefined;\n\n\t\tif (keys.length > 1) {\n\t\t\tresult = keys.map(function (i) {\n\t\t\t\treturn String(data[i]).replace(new RegExp(pattern, \"g\"), \"\").toLowerCase();\n\t\t\t}).join(delimiter);\n\t\t} else {\n\t\t\tresult = data[key];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tfunction delIndex(index, indexes, delimiter, key, data, pattern) {\n\t\tindex.forEach(function (i) {\n\t\t\tvar idx = indexes.get(i),\n\t\t\t    value = keyIndex(i, data, delimiter, pattern),\n\t\t\t    o = undefined;\n\n\t\t\tif (idx.has(value)) {\n\t\t\t\to = idx.get(value);\n\t\t\t\to[\"delete\"](key);\n\n\t\t\t\tif (o.size === 0) {\n\t\t\t\t\tidx[\"delete\"](value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction iterate(obj, fn) {\n\t\tif (obj instanceof Object) {\n\t\t\tObject.keys(obj).forEach(function (i) {\n\t\t\t\tfn.call(obj, obj[i], i);\n\t\t\t});\n\t\t} else {\n\t\t\tobj.forEach(fn);\n\t\t}\n\t}\n\n\tfunction merge(a, b) {\n\t\tvar c = a !== undefined ? clone(a) : a,\n\t\t    d = b !== undefined ? clone(b) : b;\n\n\t\tif (c instanceof Object && d instanceof Object) {\n\t\t\tObject.keys(d).forEach(function (i) {\n\t\t\t\tif (c[i] instanceof Object && d[i] instanceof Object) {\n\t\t\t\t\tc[i] = merge(c[i], d[i]);\n\t\t\t\t} else if (c[i] instanceof Array && d[i] instanceof Array) {\n\t\t\t\t\tc[i] = c[i].concat(d[i]);\n\t\t\t\t} else {\n\t\t\t\t\tc[i] = d[i];\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (c instanceof Array && d instanceof Array) {\n\t\t\tc = c.concat(d);\n\t\t} else {\n\t\t\tc = d;\n\t\t}\n\n\t\treturn c;\n\t}\n\n\tfunction patch() {\n\t\tvar ogdata = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\t\tvar data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\tvar key = arguments.length <= 2 || arguments[2] === undefined ? \"\" : arguments[2];\n\t\tvar overwrite = arguments.length <= 3 || arguments[3] === undefined ? false : arguments[3];\n\n\t\tvar result = [];\n\n\t\tif (overwrite) {\n\t\t\titerate(ogdata, function (v, k) {\n\t\t\t\tif (k !== key && data[k] === undefined) {\n\t\t\t\t\tresult.push({ op: \"remove\", path: \"/\" + k });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\titerate(data, function (v, k) {\n\t\t\tif (k !== key && ogdata[k] === undefined) {\n\t\t\t\tresult.push({ op: \"add\", path: \"/\" + k, value: v });\n\t\t\t} else if (JSON.stringify(ogdata[k]) !== JSON.stringify(v)) {\n\t\t\t\tresult.push({ op: \"replace\", path: \"/\" + k, value: v });\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tfunction s() {\n\t\treturn ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);\n\t}\n\n\tfunction setIndexValue(index, key, value) {\n\t\tif (!index.has(key)) {\n\t\t\tindex.set(key, new Set());\n\t\t}\n\n\t\tindex.get(key).add(value);\n\t}\n\n\tfunction setIndex(index, indexes, delimiter, key, data, indice, pattern) {\n\t\tif (!indice) {\n\t\t\tindex.forEach(function (i) {\n\t\t\t\tsetIndexValue(indexes.get(i), keyIndex(i, data, delimiter, pattern), key);\n\t\t\t});\n\t\t} else {\n\t\t\tsetIndexValue(indexes.get(indice), keyIndex(indice, data, delimiter, pattern), key);\n\t\t}\n\t}\n\n\tfunction toObjekt(arg) {\n\t\tvar result = {};\n\n\t\targ.forEach(function (value, key) {\n\t\t\tresult[key] = value;\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tfunction uuid() {\n\t\treturn s() + s() + \"-\" + s() + \"-4\" + s().substr(0, 3) + \"-\" + r[Math.floor(Math.random() * 4)] + s().substr(0, 3) + \"-\" + s() + s() + s();\n\t}\n\n\tvar Haro = (function () {\n\t\tfunction Haro(data) {\n\t\t\tvar _this = this;\n\n\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n\t\t\t_classCallCheck(this, Haro);\n\n\t\t\tthis.adapters = {};\n\t\t\tthis.data = new Map();\n\t\t\tthis.delimiter = \"|\";\n\t\t\tthis.config = {\n\t\t\t\tmethod: \"get\",\n\t\t\t\tcredentials: false,\n\t\t\t\theaders: {\n\t\t\t\t\taccept: \"application/json\",\n\t\t\t\t\t\"content-type\": \"application/json\"\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.id = uuid();\n\t\t\tthis.index = [];\n\t\t\tthis.indexes = new Map();\n\t\t\tthis.key = \"\";\n\t\t\tthis.logging = true;\n\t\t\tthis.patch = false;\n\t\t\tthis.pattern = \"\\\\s*|\\\\t*\";\n\t\t\tthis.registry = [];\n\t\t\tthis.source = \"\";\n\t\t\tthis.total = 0;\n\t\t\tthis.uri = \"\";\n\t\t\tthis.worker = undefined;\n\t\t\tthis.versions = new Map();\n\t\t\tthis.versioning = true;\n\n\t\t\tObject.keys(config).forEach(function (i) {\n\t\t\t\t_this[i] = merge(_this[i], config[i]);\n\t\t\t});\n\n\t\t\tthis.reindex();\n\n\t\t\tif (data) {\n\t\t\t\tthis.batch(data, \"set\");\n\t\t\t}\n\t\t}\n\n\t\t_createClass(Haro, [{\n\t\t\tkey: \"batch\",\n\t\t\tvalue: function batch(args, type) {\n\t\t\t\tvar _this2 = this;\n\n\t\t\t\tvar lload = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n\t\t\t\tvar defer = deferred(),\n\t\t\t\t    del = type === \"del\",\n\t\t\t\t    data = undefined,\n\t\t\t\t    fn = undefined,\n\t\t\t\t    hash = undefined;\n\n\t\t\t\tfunction next() {\n\t\t\t\t\tPromise.all(args.map(fn)).then(defer.resolve, defer.reject);\n\t\t\t\t}\n\n\t\t\t\tif (del) {\n\t\t\t\t\tfn = function (i) {\n\t\t\t\t\t\treturn _this2.del(i, true);\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tfn = function (i) {\n\t\t\t\t\t\treturn _this2.set(null, i, true, true, lload);\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (this.patch) {\n\t\t\t\t\tif (del) {\n\t\t\t\t\t\tdata = patch(this.toArray().map(function (i) {\n\t\t\t\t\t\t\treturn i[_this2.key];\n\t\t\t\t\t\t}), args, this.key, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata = [];\n\t\t\t\t\t\thash = {};\n\t\t\t\t\t\targs.forEach(function (i) {\n\t\t\t\t\t\t\tvar key = i[_this2.key];\n\n\t\t\t\t\t\t\tif (key) {\n\t\t\t\t\t\t\t\thash[key] = i;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdata.push({ op: \"add\", path: \"/\", value: i });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdata = data.concat(patch(this.toObject(), hash, this.key, true));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (data.length > 0) {\n\t\t\t\t\t\tthis.request(concatURI(this.uri, null), {\n\t\t\t\t\t\t\tmethod: \"patch\",\n\t\t\t\t\t\t\tbody: JSON.stringify(data)\n\t\t\t\t\t\t}).then(function () {\n\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t}, defer.reject);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdefer.resolve();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnext();\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tthis.total = 0;\n\t\t\t\tthis.registry = [];\n\t\t\t\tthis.data.clear();\n\t\t\t\tthis.indexes.clear();\n\t\t\t\tthis.versions.clear();\n\n\t\t\t\tif (this.logging) {\n\t\t\t\t\tconsole.log(\"Cleared\", this.id);\n\t\t\t\t}\n\n\t\t\t\treturn this.reindex();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"cmd\",\n\t\t\tvalue: function cmd(type) {\n\t\t\t\tvar defer = deferred();\n\n\t\t\t\tif (!this.adapters[type] || !adapter[type]) {\n\t\t\t\t\tdefer.reject(new Error(type + \" not configured for persistent storage\"));\n\t\t\t\t} else {\n\t\t\t\t\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t\t\t\t\t\targs[_key - 1] = arguments[_key];\n\t\t\t\t\t}\n\n\t\t\t\t\tadapter[type].apply(this, [this].concat(args)).then(defer.resolve, defer.reject);\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"del\",\n\t\t\tvalue: function del(key) {\n\t\t\t\tvar _this3 = this;\n\n\t\t\t\tvar batch = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n\t\t\t\tvar defer = deferred(),\n\t\t\t\t    next = undefined;\n\n\t\t\t\tnext = function () {\n\t\t\t\t\tvar index = _this3.registry.indexOf(key);\n\n\t\t\t\t\tif (index > -1) {\n\t\t\t\t\t\tif (index === 0) {\n\t\t\t\t\t\t\t_this3.registry.shift();\n\t\t\t\t\t\t} else if (index === _this3.registry.length - 1) {\n\t\t\t\t\t\t\t_this3.registry.pop();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this3.registry.splice(index, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdelIndex(_this3.index, _this3.indexes, _this3.delimiter, key, _this3.data.get(key), _this3.pattern);\n\t\t\t\t\t\t_this3.data[\"delete\"](key);\n\t\t\t\t\t\t--_this3.total;\n\n\t\t\t\t\t\tif (_this3.versioning) {\n\t\t\t\t\t\t\t_this3.versions[\"delete\"](key);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_this3.storage(\"remove\", key).then(function (success) {\n\t\t\t\t\t\t\tif (success && _this3.logging) {\n\t\t\t\t\t\t\t\tconsole.log(\"Deleted\", key, \"from persistent storage\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, function (e) {\n\t\t\t\t\t\t\tif (_this3.logging) {\n\t\t\t\t\t\t\t\tconsole.error(\"Error deleting\", key, \"from persistent storage:\", e.message || e.stack || e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tdefer.resolve();\n\t\t\t\t};\n\n\t\t\t\tif (this.data.has(key)) {\n\t\t\t\t\tif (!batch && this.uri) {\n\t\t\t\t\t\tif (this.patch) {\n\t\t\t\t\t\t\tthis.request(concatURI(this.uri, null), {\n\t\t\t\t\t\t\t\tmethod: \"patch\",\n\t\t\t\t\t\t\t\tbody: JSON.stringify([{ op: \"remove\", path: \"/\" + key }])\n\t\t\t\t\t\t\t}).then(next, function (e) {\n\t\t\t\t\t\t\t\tif (e[1] === 405) {\n\t\t\t\t\t\t\t\t\t_this3.patch = false;\n\t\t\t\t\t\t\t\t\t_this3.request(concatURI(_this3.uri, key), {\n\t\t\t\t\t\t\t\t\t\tmethod: \"delete\"\n\t\t\t\t\t\t\t\t\t}).then(next, defer.reject);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdefer.reject(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.request(concatURI(this.uri, key), {\n\t\t\t\t\t\t\t\tmethod: \"delete\"\n\t\t\t\t\t\t\t}).then(next, defer.reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdefer.reject(new Error(\"Record not found\"));\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dump\",\n\t\t\tvalue: function dump() {\n\t\t\t\tvar type = arguments.length <= 0 || arguments[0] === undefined ? \"records\" : arguments[0];\n\n\t\t\t\tvar result = undefined;\n\n\t\t\t\tif (type === \"records\") {\n\t\t\t\t\tresult = this.toArray(null, false);\n\t\t\t\t} else {\n\t\t\t\t\tresult = this.transform(this.indexes);\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"entries\",\n\t\t\tvalue: function entries() {\n\t\t\t\treturn this.data.entries();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"find\",\n\t\t\tvalue: function find(where) {\n\t\t\t\tvar _this4 = this;\n\n\t\t\t\tvar key = Object.keys(where).sort().join(this.delimiter),\n\t\t\t\t    value = keyIndex(key, where, this.delimiter),\n\t\t\t\t    result = [];\n\n\t\t\t\tif (this.indexes.has(key)) {\n\t\t\t\t\t(this.indexes.get(key).get(value) || new Set()).forEach(function (i) {\n\t\t\t\t\t\tresult.push(_this4.get(i));\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn tuple.apply(tuple, result);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"filter\",\n\t\t\tvalue: function filter(fn) {\n\t\t\t\tvar result = [];\n\n\t\t\t\tthis.forEach(function (value, key) {\n\t\t\t\t\tif (fn(value, key) === true) {\n\t\t\t\t\t\tresult.push(tuple(key, value));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn tuple.apply(tuple, result);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"forEach\",\n\t\t\tvalue: function forEach(fn, ctx) {\n\t\t\t\tthis.data.forEach(function (value, key) {\n\t\t\t\t\tfn(clone(value), clone(key));\n\t\t\t\t}, ctx);\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"get\",\n\t\t\tvalue: function get(key) {\n\t\t\t\tvar output = undefined;\n\n\t\t\t\tif (this.data.has(key)) {\n\t\t\t\t\toutput = tuple(key, this.data.get(key));\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"has\",\n\t\t\tvalue: function has(key) {\n\t\t\t\treturn this.data.has(key);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"keys\",\n\t\t\tvalue: function keys() {\n\t\t\t\treturn this.data.keys();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"limit\",\n\t\t\tvalue: function limit(max) {\n\t\t\t\tvar offset = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n\t\t\t\tvar lmax = max,\n\t\t\t\t    loffset = offset,\n\t\t\t\t    list = [],\n\t\t\t\t    i = undefined,\n\t\t\t\t    k = undefined,\n\t\t\t\t    nth = undefined;\n\n\t\t\t\tif (lmax === undefined) {\n\t\t\t\t\tlmax = -1;\n\t\t\t\t}\n\n\t\t\t\ti = loffset;\n\t\t\t\tnth = loffset + lmax;\n\n\t\t\t\tif (i < 0 || i >= nth) {\n\t\t\t\t\tthrow new Error(\"Invalid range\");\n\t\t\t\t}\n\n\t\t\t\tdo {\n\t\t\t\t\tk = this.registry[i];\n\n\t\t\t\t\tif (k) {\n\t\t\t\t\t\tlist.push(this.get(k));\n\t\t\t\t\t}\n\t\t\t\t} while (++i < nth);\n\n\t\t\t\treturn tuple.apply(tuple, list);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"load\",\n\t\t\tvalue: function load() {\n\t\t\t\tvar _this5 = this;\n\n\t\t\t\tvar type = arguments.length <= 0 || arguments[0] === undefined ? \"mongo\" : arguments[0];\n\t\t\t\tvar key = arguments.length <= 1 || arguments[1] === undefined ? undefined : arguments[1];\n\n\t\t\t\tvar batch = key === undefined,\n\t\t\t\t    id = !batch ? key : this.id;\n\n\t\t\t\tif (batch) {\n\t\t\t\t\tthis.clear();\n\t\t\t\t}\n\n\t\t\t\treturn this.cmd(type, \"get\", key).then(function (arg) {\n\t\t\t\t\tif (_this5.logging) {\n\t\t\t\t\t\tconsole.log(\"Loaded\", id, \"from\", type, \"persistent storage\");\n\t\t\t\t\t}\n\n\t\t\t\t\treturn batch ? _this5.batch(arg, \"set\", true) : _this5.set(key, arg, true, true, true);\n\t\t\t\t}, function (e) {\n\t\t\t\t\tif (_this5.logging) {\n\t\t\t\t\t\tconsole.error(\"Error loading\", id, \"from\", type, \"persistent storage:\", e.message || e.stack || e);\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow e;\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"map\",\n\t\t\tvalue: function map(fn) {\n\t\t\t\tvar result = [];\n\n\t\t\t\tthis.forEach(function (value, key) {\n\t\t\t\t\tresult.push(fn(value, key));\n\t\t\t\t});\n\n\t\t\t\treturn tuple.apply(tuple, result);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"override\",\n\t\t\tvalue: function override(data) {\n\t\t\t\tvar _this6 = this;\n\n\t\t\t\tvar type = arguments.length <= 1 || arguments[1] === undefined ? \"records\" : arguments[1];\n\t\t\t\tvar fn = arguments.length <= 2 || arguments[2] === undefined ? undefined : arguments[2];\n\n\t\t\t\tvar defer = deferred();\n\n\t\t\t\tif (type === \"indexes\") {\n\t\t\t\t\tthis.indexes = this.transform(data, fn);\n\t\t\t\t\tdefer.resolve(true);\n\t\t\t\t} else if (type === \"records\") {\n\t\t\t\t\tthis.data = new Map();\n\t\t\t\t\tthis.registry = [];\n\t\t\t\t\tdata.forEach(function (datum) {\n\t\t\t\t\t\tvar key = datum[_this6.key] || uuid();\n\n\t\t\t\t\t\t_this6.data.set(key, datum);\n\t\t\t\t\t\t_this6.registry.push(key);\n\t\t\t\t\t});\n\t\t\t\t\tthis.total = this.data.size;\n\t\t\t\t\tdefer.resolve(true);\n\t\t\t\t} else {\n\t\t\t\t\tdefer.reject(new Error(\"Invalid type\"));\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"register\",\n\t\t\tvalue: function register(key, fn) {\n\t\t\t\tadapter[key] = fn;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reindex\",\n\t\t\tvalue: function reindex(index) {\n\t\t\t\tvar _this7 = this;\n\n\t\t\t\tif (!index) {\n\t\t\t\t\tthis.indexes.clear();\n\t\t\t\t\tthis.index.forEach(function (i) {\n\t\t\t\t\t\t_this7.indexes.set(i, new Map());\n\t\t\t\t\t});\n\t\t\t\t\tthis.forEach(function (data, key) {\n\t\t\t\t\t\t_this7.index.forEach(function (i) {\n\t\t\t\t\t\t\tsetIndex(_this7.index, _this7.indexes, _this7.delimiter, key, data, i, _this7.pattern);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.indexes.set(index, new Map());\n\t\t\t\t\tthis.forEach(function (data, key) {\n\t\t\t\t\t\tsetIndex(_this7.index, _this7.indexes, _this7.delimiter, key, data, index, _this7.pattern);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"request\",\n\t\t\tvalue: function request(input) {\n\t\t\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n\t\t\t\tvar defer = deferred(),\n\t\t\t\t    cfg = merge(this.config, config);\n\n\t\t\t\tcfg.method = cfg.method.toUpperCase();\n\n\t\t\t\tfetch(input, cfg).then(function (res) {\n\t\t\t\t\tvar status = res.status,\n\t\t\t\t\t    headers = undefined;\n\n\t\t\t\t\tif (res.headers._headers) {\n\t\t\t\t\t\theaders = {};\n\t\t\t\t\t\tObject.keys(res.headers._headers).forEach(function (i) {\n\t\t\t\t\t\t\theaders[i] = res.headers._headers[i].join(\", \");\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\theaders = toObjekt(res.headers);\n\t\t\t\t\t}\n\n\t\t\t\t\tres[res.headers.get(\"content-type\").indexOf(\"application/json\") > -1 ? \"json\" : \"text\"]().then(function (arg) {\n\t\t\t\t\t\tdefer[status < 200 || status >= 400 ? \"reject\" : \"resolve\"](tuple(arg, status, headers));\n\t\t\t\t\t}, function (e) {\n\t\t\t\t\t\tdefer.reject(tuple(e.message, status, headers));\n\t\t\t\t\t});\n\t\t\t\t}, function (e) {\n\t\t\t\t\tdefer.reject(tuple(e.message, 0, {}));\n\t\t\t\t});\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"save\",\n\t\t\tvalue: function save() {\n\t\t\t\tvar _this8 = this;\n\n\t\t\t\tvar type = arguments.length <= 0 || arguments[0] === undefined ? \"mongo\" : arguments[0];\n\n\t\t\t\treturn this.cmd(type, \"set\").then(function (arg) {\n\t\t\t\t\tif (_this8.logging) {\n\t\t\t\t\t\tconsole.log(\"Saved\", _this8.id, \"to\", type, \"persistent storage\");\n\t\t\t\t\t}\n\n\t\t\t\t\treturn arg;\n\t\t\t\t}, function (e) {\n\t\t\t\t\tif (_this8.logging) {\n\t\t\t\t\t\tconsole.error(\"Error saving \", _this8.id, \"to\", type, \"persistent storage:\", e.message || e.stack || e);\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow e;\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"search\",\n\t\t\tvalue: function search(value, index) {\n\t\t\t\tvar _this9 = this;\n\n\t\t\t\tvar result = [],\n\t\t\t\t    fn = typeof value === \"function\",\n\t\t\t\t    rgex = value && typeof value.test === \"function\",\n\t\t\t\t    seen = new Set(),\n\t\t\t\t    lindex = undefined,\n\t\t\t\t    indexes = undefined;\n\n\t\t\t\tif (value) {\n\t\t\t\t\tlindex = clone(index || this.index);\n\n\t\t\t\t\tif (lindex instanceof Array) {\n\t\t\t\t\t\tindexes = lindex;\n\t\t\t\t\t} else if (typeof lindex === \"string\") {\n\t\t\t\t\t\tindexes = [lindex];\n\t\t\t\t\t}\n\n\t\t\t\t\tindexes.forEach(function (i) {\n\t\t\t\t\t\tvar idx = _this9.indexes.get(i);\n\n\t\t\t\t\t\tif (idx) {\n\t\t\t\t\t\t\tidx.forEach(function (lset, lkey) {\n\t\t\t\t\t\t\t\tswitch (true) {\n\t\t\t\t\t\t\t\t\tcase fn && value(lkey, i):\n\t\t\t\t\t\t\t\t\tcase rgex && value.test(lkey):\n\t\t\t\t\t\t\t\t\tcase lkey === value:\n\t\t\t\t\t\t\t\t\t\tlset.forEach(function (key) {\n\t\t\t\t\t\t\t\t\t\t\tif (!seen.has(key)) {\n\t\t\t\t\t\t\t\t\t\t\t\tseen.add(key);\n\t\t\t\t\t\t\t\t\t\t\t\tresult.push(_this9.get(key));\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tvoid 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn tuple.apply(tuple, result);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"set\",\n\t\t\tvalue: function set(key, data) {\n\t\t\t\tvar batch = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n\t\t\t\tvar _this10 = this;\n\n\t\t\t\tvar override = arguments.length <= 3 || arguments[3] === undefined ? false : arguments[3];\n\t\t\t\tvar lload = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];\n\n\t\t\t\tvar defer = deferred(),\n\t\t\t\t    method = \"post\",\n\t\t\t\t    ldata = clone(data),\n\t\t\t\t    lkey = key,\n\t\t\t\t    body = undefined,\n\t\t\t\t    ogdata = undefined,\n\t\t\t\t    luri = undefined;\n\n\t\t\t\tvar next = function next(arg) {\n\t\t\t\t\tvar xdata = arg ? arg[0] : {};\n\n\t\t\t\t\tif (lkey === null) {\n\t\t\t\t\t\tif (_this10.key) {\n\t\t\t\t\t\t\tif (_this10.source) {\n\t\t\t\t\t\t\t\t_this10.source.split(\".\").forEach(function (i) {\n\t\t\t\t\t\t\t\t\txdata = xdata[i] || {};\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlkey = xdata[_this10.key] || ldata[_this10.key] || uuid();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlkey = uuid();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (method === \"post\") {\n\t\t\t\t\t\t_this10.registry[_this10.total] = lkey;\n\t\t\t\t\t\t++_this10.total;\n\n\t\t\t\t\t\tif (_this10.versioning) {\n\t\t\t\t\t\t\t_this10.versions.set(lkey, new Set());\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (_this10.versioning) {\n\t\t\t\t\t\t\t_this10.versions.get(lkey).add(tuple(ogdata));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdelIndex(_this10.index, _this10.indexes, _this10.delimiter, lkey, ogdata, _this10.pattern);\n\t\t\t\t\t}\n\n\t\t\t\t\t_this10.data.set(lkey, ldata);\n\t\t\t\t\tsetIndex(_this10.index, _this10.indexes, _this10.delimiter, lkey, ldata, null, _this10.pattern);\n\t\t\t\t\tdefer.resolve(_this10.get(lkey));\n\n\t\t\t\t\tif (!lload) {\n\t\t\t\t\t\t_this10.storage(\"set\", lkey, ldata).then(function (success) {\n\t\t\t\t\t\t\tif (success && _this10.logging) {\n\t\t\t\t\t\t\t\tconsole.log(\"Saved\", lkey, \"to persistent storage\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, function (e) {\n\t\t\t\t\t\t\tif (_this10.logging) {\n\t\t\t\t\t\t\t\tconsole.error(\"Error saving\", lkey, \"to persistent storage:\", e.message || e.stack || e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (lkey === undefined || lkey === null) {\n\t\t\t\t\tlkey = null;\n\t\t\t\t} else if (this.data.has(lkey)) {\n\t\t\t\t\tmethod = \"put\";\n\t\t\t\t\togdata = this.data.get(lkey);\n\n\t\t\t\t\tif (!override) {\n\t\t\t\t\t\tldata = merge(ogdata, ldata);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!batch && this.uri) {\n\t\t\t\t\tluri = concatURI(this.uri, lkey);\n\n\t\t\t\t\tif (this.patch) {\n\t\t\t\t\t\tif (method === \"post\") {\n\t\t\t\t\t\t\tbody = [{ op: \"add\", path: \"/\", value: ldata }];\n\t\t\t\t\t\t} else if (override) {\n\t\t\t\t\t\t\tbody = [{ op: \"replace\", path: \"/\", value: ldata }];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbody = patch(ogdata, ldata, this.key);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.request(luri, {\n\t\t\t\t\t\t\tmethod: \"patch\",\n\t\t\t\t\t\t\tbody: JSON.stringify(body)\n\t\t\t\t\t\t}).then(next, function (e) {\n\t\t\t\t\t\t\tif (e[1] === 405) {\n\t\t\t\t\t\t\t\t_this10.patch = false;\n\t\t\t\t\t\t\t\t_this10.request(luri, {\n\t\t\t\t\t\t\t\t\tmethod: method,\n\t\t\t\t\t\t\t\t\tbody: JSON.stringify(ldata)\n\t\t\t\t\t\t\t\t}).then(next, function (err) {\n\t\t\t\t\t\t\t\t\tdefer.reject(err);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdefer.reject(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.request(luri, {\n\t\t\t\t\t\t\tmethod: method,\n\t\t\t\t\t\t\tbody: JSON.stringify(ldata)\n\t\t\t\t\t\t}).then(next, function (e) {\n\t\t\t\t\t\t\tdefer.reject(e);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnext();\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setUri\",\n\t\t\tvalue: function setUri(uri) {\n\t\t\t\tvar clear = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n\t\t\t\tvar defer = deferred();\n\n\t\t\t\tthis.uri = uri;\n\n\t\t\t\tif (this.uri) {\n\t\t\t\t\tthis.sync(clear).then(defer.resolve, defer.reject);\n\t\t\t\t} else {\n\t\t\t\t\tdefer.resolve([]);\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"sort\",\n\t\t\tvalue: function sort(fn) {\n\t\t\t\tvar frozen = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\n\t\t\t\tvar result = undefined;\n\n\t\t\t\tif (frozen) {\n\t\t\t\t\tresult = Object.freeze(this.toArray(null, false).sort(fn).map(function (i) {\n\t\t\t\t\t\treturn Object.freeze(i);\n\t\t\t\t\t}));\n\t\t\t\t} else {\n\t\t\t\t\tresult = this.toArray(null, false).sort(fn);\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"sortBy\",\n\t\t\tvalue: function sortBy(index) {\n\t\t\t\tvar _this11 = this;\n\n\t\t\t\tvar result = [],\n\t\t\t\t    keys = [],\n\t\t\t\t    lindex = undefined;\n\n\t\t\t\tif (!this.indexes.has(index)) {\n\t\t\t\t\tthis.index.push(index);\n\t\t\t\t\tthis.reindex(index);\n\t\t\t\t}\n\n\t\t\t\tlindex = this.indexes.get(index);\n\t\t\t\tlindex.forEach(function (idx, key) {\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t});\n\n\t\t\t\tkeys.sort().forEach(function (i) {\n\t\t\t\t\tlindex.get(i).forEach(function (key) {\n\t\t\t\t\t\tresult.push(_this11.get(key));\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\treturn tuple.apply(tuple, result);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"storage\",\n\t\t\tvalue: function storage() {\n\t\t\t\tvar _this12 = this;\n\n\t\t\t\tfor (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t\t\t\t\targs[_key2] = arguments[_key2];\n\t\t\t\t}\n\n\t\t\t\tvar defer = deferred(),\n\t\t\t\t    deferreds = [];\n\n\t\t\t\tObject.keys(this.adapters).forEach(function (i) {\n\t\t\t\t\tdeferreds.push(_this12.cmd.apply(_this12, [i].concat(args)));\n\t\t\t\t});\n\n\t\t\t\tif (deferreds.length > 0) {\n\t\t\t\t\tPromise.all(deferreds).then(function () {\n\t\t\t\t\t\tdefer.resolve(true);\n\t\t\t\t\t}, defer.reject);\n\t\t\t\t} else {\n\t\t\t\t\tdefer.resolve(false);\n\t\t\t\t}\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"sync\",\n\t\t\tvalue: function sync() {\n\t\t\t\tvar _this13 = this;\n\n\t\t\t\tvar clear = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\n\t\t\t\tvar defer = deferred();\n\n\t\t\t\tthis.request(this.uri).then(function (arg) {\n\t\t\t\t\tvar data = arg[0];\n\n\t\t\t\t\t_this13.patch = (arg[2].Allow || arg[2].allow || \"\").indexOf(\"PATCH\") > -1;\n\n\t\t\t\t\tif (_this13.source) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t_this13.source.split(\".\").forEach(function (i) {\n\t\t\t\t\t\t\t\tdata = data[i];\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\treturn defer.reject(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (clear) {\n\t\t\t\t\t\t_this13.clear();\n\t\t\t\t\t}\n\n\t\t\t\t\t_this13.batch(data, \"set\").then(defer.resolve, defer.reject);\n\t\t\t\t}, function (e) {\n\t\t\t\t\tdefer.reject(e[0] || e);\n\t\t\t\t});\n\n\t\t\t\treturn defer.promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toArray\",\n\t\t\tvalue: function toArray(data) {\n\t\t\t\tvar frozen = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\n\t\t\t\tvar key = this.key,\n\t\t\t\t    fn = undefined,\n\t\t\t\t    result = undefined;\n\n\t\t\t\tif (data) {\n\t\t\t\t\tfn = (function () {\n\t\t\t\t\t\tif (key) {\n\t\t\t\t\t\t\treturn function (a, b) {\n\t\t\t\t\t\t\t\tvar obj = clone(b[1]);\n\n\t\t\t\t\t\t\t\tif (obj[key] === undefined) {\n\t\t\t\t\t\t\t\t\tobj[key] = clone(b[0]);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ta.push(obj);\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn function (a, b) {\n\t\t\t\t\t\t\t\ta.push(clone(b[1]));\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t})();\n\t\t\t\t\tresult = data.reduce(fn, []);\n\t\t\t\t} else {\n\t\t\t\t\tfn = (function () {\n\t\t\t\t\t\tif (key) {\n\t\t\t\t\t\t\treturn function (val, id) {\n\t\t\t\t\t\t\t\tvar obj = clone(val);\n\n\t\t\t\t\t\t\t\tif (obj[key] === undefined) {\n\t\t\t\t\t\t\t\t\tobj[key] = clone(id);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult.push(obj);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn function (val) {\n\t\t\t\t\t\t\t\tresult.push(clone(val));\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t})();\n\t\t\t\t\tresult = [];\n\t\t\t\t\tthis.forEach(fn);\n\t\t\t\t}\n\n\t\t\t\treturn frozen ? Object.freeze(result) : result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"toObject\",\n\t\t\tvalue: function toObject(data) {\n\t\t\t\tvar frozen = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\n\t\t\t\tvar func = undefined;\n\n\t\t\t\tif (frozen) {\n\t\t\t\t\tfunc = function (arg) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tfunc = function (arg) {\n\t\t\t\t\t\treturn clone(arg);\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn func(!data ? toObjekt(this) : data.reduce(function (a, b) {\n\t\t\t\t\ta[b[0]] = b[1];\n\n\t\t\t\t\treturn a;\n\t\t\t\t}, {}));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"transform\",\n\t\t\tvalue: function transform(input, fn) {\n\t\t\t\tvar _this14 = this;\n\n\t\t\t\tvar result = undefined;\n\n\t\t\t\tif (typeof fn === \"function\") {\n\t\t\t\t\tresult = fn(input);\n\t\t\t\t} else {\n\t\t\t\t\tswitch (true) {\n\t\t\t\t\t\tcase input instanceof Map:\n\t\t\t\t\t\t\tresult = {};\n\t\t\t\t\t\t\tinput.forEach(function (value, key) {\n\t\t\t\t\t\t\t\tresult[key] = _this14.transform(value);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase input instanceof Set:\n\t\t\t\t\t\t\tresult = [];\n\t\t\t\t\t\t\tinput.forEach(function (i) {\n\t\t\t\t\t\t\t\tresult.push(_this14.transform(i));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase input instanceof Array:\n\t\t\t\t\t\t\tresult = new Set();\n\t\t\t\t\t\t\tinput.forEach(function (i) {\n\t\t\t\t\t\t\t\tresult.add(_this14.transform(i));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase input instanceof Object:\n\t\t\t\t\t\t\tresult = new Map();\n\t\t\t\t\t\t\tObject.keys(input).forEach(function (i) {\n\t\t\t\t\t\t\t\tresult.set(i, _this14.transform(input[i]));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tresult = input;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unload\",\n\t\t\tvalue: function unload() {\n\t\t\t\tvar _this15 = this;\n\n\t\t\t\tvar type = arguments.length <= 0 || arguments[0] === undefined ? \"mongo\" : arguments[0];\n\t\t\t\tvar key = arguments.length <= 1 || arguments[1] === undefined ? undefined : arguments[1];\n\n\t\t\t\tvar id = key !== undefined ? key : this.id;\n\n\t\t\t\treturn this.cmd(type, \"remove\", key).then(function (arg) {\n\t\t\t\t\tif (_this15.logging) {\n\t\t\t\t\t\tconsole.log(\"Unloaded\", id, \"from\", type, \"persistent storage\");\n\t\t\t\t\t}\n\n\t\t\t\t\treturn arg;\n\t\t\t\t}, function (e) {\n\t\t\t\t\tif (_this15.logging) {\n\t\t\t\t\t\tconsole.error(\"Error unloading\", id, \"from\", type, \"persistent storage:\", e.message || e.stack || e);\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow e;\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unregister\",\n\t\t\tvalue: function unregister(key) {\n\t\t\t\tdelete adapter[key];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"values\",\n\t\t\tvalue: function values() {\n\t\t\t\treturn this.data.values();\n\t\t\t}\n\t\t}]);\n\n\t\treturn Haro;\n\t})();\n\n\tfunction factory() {\n\t\tvar data = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t\tvar config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\tvar indexes = arguments.length <= 2 || arguments[2] === undefined ? [] : arguments[2];\n\n\t\tvar obj = new Haro(data, config, indexes),\n\t\t    fns = [];\n\n\t\tif (webWorker) {\n\t\t\ttry {\n\t\t\t\tobj.worker = global.URL.createObjectURL(blob(fns.join(\"\\n\")));\n\t\t\t} catch (e) {\n\t\t\t\tobj.worker = null;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tfactory.version = \"1.6.2\";\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\") {\n\t\tdefine(function () {\n\t\t\treturn factory;\n\t\t});\n\t} else {\n\t\tglobal.haro = factory;\n\t}\n})(typeof global !== \"undefined\" ? global : window);\n"]}